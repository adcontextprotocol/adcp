---
title: Task Reference
description: API reference for portfolio tasks
---

This page documents all tasks available for managing portfolios.

## create_portfolio

Creates a new portfolio workspace on a creative agent.

### Request

```json
{
  "name": "Spring Campaign 2025",
  "description": "Creatives for Q2 spring promotion",
  "brand_manifest_url": "https://brand.com/manifest.json",
  "assets": [
    {
      "asset_id": "hero_image",
      "url": "https://cdn.brand.com/hero.jpg",
      "asset_type": "image",
      "tags": ["hero", "product"],
      "name": "Hero Product Shot"
    }
  ],
  "trackers": {
    "click": "https://track.brand.com/click?dest={LANDING_URL_ENC}&cb={CACHEBUSTER}",
    "impression": ["https://track.brand.com/imp?cb={CACHEBUSTER}"]
  },
  "push_notification_config": {
    "url": "https://buyer.com/webhooks/creative-updates"
  }
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | Yes | Human-readable name |
| `description` | string | No | Purpose description |
| `brand_manifest_url` | string | Yes | URL to live brand manifest |
| `assets` | array | No | Source assets for building creatives |
| `trackers` | object | No | Tracker URL templates with macros |
| `push_notification_config` | object | No | Webhook config for state changes |

### Response

```json
{
  "portfolio_id": "cs_abc123",
  "name": "Spring Campaign 2025",
  "archived": false,
  "creatives": [],
  "created_at": "2025-01-15T10:00:00Z"
}
```

---

## get_portfolio

Retrieves a portfolio with its creatives and ad tags.

### Request

```json
{
  "portfolio_id": "cs_abc123",
  "format_ids": [
    { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_300x250" }
  ],
  "include_previews": true,
  "include_ad_tags": true,
  "auto_build": false
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `portfolio_id` | string | Yes | Portfolio to retrieve |
| `format_ids` | array | No | Filter to specific formats |
| `include_previews` | boolean | No | Include preview URLs (default: true) |
| `include_ad_tags` | boolean | No | Include full ad tag markup (default: true) |
| `auto_build` | boolean | No | If requested formats don't exist, build them on-demand (default: false) |

### Lazy Loading with auto_build

When `auto_build: true`, the creative agent will generate creatives for any requested formats that don't already exist in the portfolio. This enables lazy loading workflows where seller agents can request formats as needed without orchestrator intervention.

**Behavior:**
- If all requested formats exist: Returns immediately with existing creatives
- If some formats are missing and `auto_build: true`: Builds missing formats, then returns all creatives
- If some formats are missing and `auto_build: false`: Returns only existing creatives (no error)

<Note>
Building creatives takes time. For synchronous responses, the creative agent MAY return a partial response with `building: true` for formats still being generated. The seller agent can poll or wait for a webhook notification.
</Note>

### Response

```json
{
  "portfolio_id": "cs_abc123",
  "name": "Spring Campaign 2025",
  "description": "Creatives for Q2 spring promotion",
  "archived": false,
  "creatives": [
    {
      "creative_id": "cr_display_001",
      "manifest": {
        "format_id": { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_300x250" },
        "assets": {
          "banner_image": { "type": "image", "url": "https://cdn.creative.com/built/banner.jpg" },
          "clickthrough_url": { "type": "url", "url": "https://track.brand.com/click?dest=..." }
        }
      },
      "advertiser_status": "approved",
      "preview_url": "https://creative.brand.com/preview/cr_display_001",
      "thumbnail_url": "https://creative.brand.com/thumb/cr_display_001.jpg"
    }
  ],
  "updated_at": "2025-01-15T14:30:00Z"
}
```

---

## list_portfolios

Queries portfolios with filtering and pagination.

### Request

```json
{
  "filter": {
    "archived": false,
    "search": "spring",
    "created_after": "2025-01-01T00:00:00Z"
  },
  "sort": {
    "field": "updated_at",
    "order": "desc"
  },
  "pagination": {
    "limit": 20,
    "offset": 0
  }
}
```

### Response

```json
{
  "portfolios": [
    {
      "portfolio_id": "cs_abc123",
      "name": "Spring Campaign 2025",
      "description": "Creatives for Q2 spring promotion",
      "archived": false,
      "creative_count": 5,
      "format_ids": [
        { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_300x250" },
        { "agent_url": "https://creative.adcontextprotocol.org", "id": "video_30s" }
      ],
      "created_at": "2025-01-15T10:00:00Z",
      "updated_at": "2025-01-15T14:30:00Z"
    }
  ],
  "total_count": 1
}
```

---

## update_portfolio

Modifies a portfolio including add/remove/regenerate creatives.

### Request

```json
{
  "portfolio_id": "cs_abc123",
  "name": "Spring Campaign 2025 - Updated",
  "trackers": {
    "click": "https://track.brand.com/v2/click?dest={LANDING_URL_ENC}"
  },
  "add_creatives": [
    {
      "format_id": { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_160x600" },
      "landing_url": "https://brand.com/spring-sale"
    }
  ],
  "remove_creative_ids": ["cr_old_001"],
  "regenerate_creative_ids": ["cr_display_001"],
  "regenerate_params": {
    "prompt": "Use brighter colors, emphasize urgency"
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `portfolio_id` | string | Set to update (required) |
| `name` | string | Updated name |
| `description` | string | Updated description |
| `trackers` | object | Updated tracker templates (triggers regeneration) |
| `archived` | boolean | Archive/unarchive the set |
| `add_creatives` | array | New creatives to add |
| `remove_creative_ids` | array | Creative IDs to remove |
| `regenerate_creative_ids` | array | Creative IDs to regenerate |
| `regenerate_params` | object | Parameters for regeneration |

### Response

```json
{
  "portfolio_id": "cs_abc123",
  "name": "Spring Campaign 2025 - Updated",
  "archived": false,
  "creatives": [...],
  "changes": {
    "creatives_added": ["cr_skyscraper_001"],
    "creatives_removed": ["cr_old_001"],
    "creatives_regenerating": ["cr_display_001"]
  },
  "updated_at": "2025-01-15T15:00:00Z"
}
```

---

## delete_portfolio

Archives or permanently deletes a portfolio.

### Request

```json
{
  "portfolio_id": "cs_abc123",
  "mode": "archive"
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `portfolio_id` | string | Yes | Set to delete |
| `mode` | string | No | `"archive"` (default) or `"permanent"` |

### Response

```json
{
  "portfolio_id": "cs_abc123",
  "mode": "archive",
  "deleted_at": "2025-01-15T16:00:00Z"
}
```

---

## build_creatives

Builds creatives from a portfolio's source assets for specified formats.

### Request

```json
{
  "portfolio_id": "cs_abc123",
  "target_formats": [
    { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_300x250" },
    { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_728x90" }
  ],
  "prompt": "Clean, modern design. Emphasize the 30% discount.",
  "asset_ids": ["hero_image", "logo"],
  "auto_approve": false,
  "dry_run": false
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `portfolio_id` | string | Yes | Portfolio containing source assets |
| `target_formats` | array | Yes | Formats to build |
| `prompt` | string | No | Generation guidance (overrides portfolio's `generation_prompt`) |
| `asset_ids` | array | No | Subset of assets to use |
| `auto_approve` | boolean | No | Auto-approve built creatives (default: false) |
| `dry_run` | boolean | No | Preview what would be built without actually building (default: false) |

### Dry Run Mode

When `dry_run: true`, the creative agent returns a preview of what would be generated without actually building creatives. This lets you validate your configuration before committing to a build.

**Dry run response includes:**
- Which formats can be built with available assets
- Which formats would fail and why
- Estimated creative count per format
- Optional: Low-fidelity preview thumbnails (agent-dependent)

```json
{
  "portfolio_id": "cs_abc123",
  "dry_run": true,
  "preview": [
    {
      "format_id": { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_300x250" },
      "can_build": true,
      "assets_used": ["hero_image", "logo"],
      "estimated_variants": 1,
      "preview_thumbnail": "https://creative.brand.com/dry-run/preview_300x250.jpg"
    },
    {
      "format_id": { "agent_url": "https://creative.adcontextprotocol.org", "id": "display_728x90" },
      "can_build": false,
      "reason": "Format requires video assets not present in portfolio"
    }
  ]
}
```

### Standard Response

```json
{
  "portfolio_id": "cs_abc123",
  "creatives": [
    {
      "creative_id": "cr_display_002",
      "manifest": {...},
      "advertiser_status": "pending_review",
      "preview_url": "https://creative.brand.com/preview/cr_display_002"
    }
  ],
  "errors": [
    {
      "code": "format_not_supported",
      "message": "Format display_728x90 requires video assets not present in portfolio"
    }
  ]
}
```
