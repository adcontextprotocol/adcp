---
title: preview_creative
sidebar_position: 14
---

# preview_creative

Generate preview renderings of one or more creative manifests. Supports both single creative preview and batch preview (5-10x faster for multiple creatives).

## Quick Start

### Single Creative Preview

The simplest preview request returns a single URL you can iframe:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "native_responsive"
  },
  "creative_manifest": { /* your creative */ }
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/abc123",
      "input": {
        "name": "Default",
        "macros": {}
      }
    }
  ],
  "expires_at": "2025-02-15T18:00:00Z"
}
```

Embed the preview:

```html
<iframe src="https://creative-agent.example.com/preview/abc123"
        width="600" height="400"></iframe>
```

The preview URL returns an HTML page that handles all rendering (images, video players, audio players, etc.) - no client logic needed.

### Direct HTML Embedding (No iframes)

For faster rendering and grid layouts, request HTML directly instead of URLs:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "native_responsive"
  },
  "creative_manifest": { /* your creative */ },
  "output_format": "html"
}
```

Response contains raw HTML:

```json
{
  "previews": [
    {
      "preview_html": "<div class=\"creative\"><img src=\"...\"/><h3>Headline</h3></div>",
      "input": {
        "name": "Default",
        "macros": {}
      }
    }
  ],
  "expires_at": "2025-02-15T18:00:00Z"
}
```

Embed directly in your page:

```html
<div class="preview-grid">
  <div dangerouslySetInnerHTML={{__html: preview.preview_html}} />
</div>
```

**Benefits:** No iframe overhead, faster load times, better for grids of 50+ previews.

### Batch Preview (Multiple Creatives)

Preview multiple different creatives in one API call (5-10x faster):

```json
{
  "requests": [
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "display_300x250"
      },
      "creative_manifest": { /* first creative */ }
    },
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "video_30s_vast"
      },
      "creative_manifest": { /* second creative */ }
    }
  ]
}
```

Response contains results in the same order:

```json
{
  "results": [
    {
      "success": true,
      "response": {
        "previews": [ /* first creative previews */ ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    },
    {
      "success": true,
      "response": {
        "previews": [ /* second creative previews */ ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    }
  ]
}
```

## Overview

Creative agents provide the ability to preview how creative manifests will render in given formats. This is essential for:
- **Calibration**: Testing how dynamic creatives render with different inputs
- **Review**: Visual validation before campaign launch
- **Context Testing**: Simulating different user scenarios, devices, and environments
- **Quality Assurance**: Verifying creative rendering across multiple variants
- **Bulk Workflows**: Previewing entire campaigns efficiently (batch mode)

The `preview_creative` task supports two modes:
1. **Single mode**: Preview one creative with optional variant inputs
2. **Batch mode**: Preview 1-50 different creatives in one API call (5-10x faster)

## Request Parameters

The request format depends on the mode:

### Single Mode Parameters

Use these top-level fields to preview one creative:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `format_id` | FormatID | Yes | Format identifier for rendering (structured object with agent_url and id) |
| `creative_manifest` | object | Yes | Complete creative manifest with all required assets |
| `inputs` | array | No | Array of input sets for generating multiple preview variants |
| `template_id` | string | No | Specific template for custom format rendering |
| `output_format` | string | No | Output format: `"url"` (default) returns `preview_url` for iframe embedding, `"html"` returns `preview_html` for direct embedding |

### Batch Mode Parameters

Use a top-level `requests` array to preview multiple creatives:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `requests` | array | Yes | Array of 1-50 preview requests. Each item has the same structure as single mode parameters (including `output_format`). |
| `output_format` | string | No | Default output format for all requests. Individual requests can override this with their own `output_format`. |

### Creative Manifest Structure

The creative manifest must include all assets required by the format. See [Creative Manifests](/docs/creative/creative-manifests) for detailed specification.

```typescript
{
  format_id: {                 // Must match format_id parameter
    agent_url: string;         // Creative agent URL
    id: string;                // Format identifier
  };
  assets: {
    [asset_role: string]: {    // Asset role from format spec (e.g., 'hero_image', 'logo')
      asset_type: string;      // Type: image, video, audio, vast_tag, text, url, etc.
      // Type-specific properties...
    }
  };
  metadata?: {
    advertiser?: string;
    campaign?: string;
    [key: string]: any;
  };
}
```

### Inputs Array

The `inputs` array allows you to request multiple preview variants in a single call. Each input set can specify:

```typescript
{
  name: string;                      // Human-readable name (e.g., "Mobile dark mode", "Podcast weather segment")
  macros?: {                         // Macro values to apply
    [macro_name: string]: string;    // e.g., DEVICE_TYPE: "mobile", COUNTRY: "US"
  };
  context_description?: string;      // Natural language context for AI-generated content
}
```

**Macro Support**: Use any universal macro from the format's `supported_macros` list. Available macros include:
- Common: `{MEDIA_BUY_ID}`, `{CREATIVE_ID}`, `{CACHEBUSTER}`
- Device: `{DEVICE_TYPE}`, `{OS}`, `{USER_AGENT}`
- Geographic: `{COUNTRY}`, `{REGION}`, `{CITY}`, `{DMA}`
- Privacy: `{GDPR}`, `{US_PRIVACY}`, `{LIMIT_AD_TRACKING}`
- Video: `{VIDEO_ID}`, `{POD_POSITION}`, `{CONTENT_GENRE}`

**Context Description**: For dynamic or AI-generated creatives (like host-read audio ads), provide natural language context:
- `"User just searched for running shoes"`
- `"Podcast discussing weather patterns in the Pacific Northwest"`
- `"Article about electric vehicles and sustainability"`
- `"Morning commute, user listening to news"`

**Default Behavior**: If `inputs` is not provided, you receive a single default preview. To test multiple scenarios (devices, locations, contexts), explicitly provide the `inputs` array.

## Response Format

The response format depends on the request mode:

### Single Mode Response

```json
{
  "previews": "array",
  "interactive_url": "string",
  "expires_at": "string"
}
```

**Field Descriptions:**
- **previews**: Array of preview variants. One preview per input set from the request. If no inputs provided, returns a single default preview.
- **interactive_url**: Optional URL to interactive testing page with controls to switch between variants
- **expires_at**: ISO 8601 timestamp when preview links expire

### Batch Mode Response

```json
{
  "results": [
    {
      "success": true,
      "response": {
        "previews": "array",
        "interactive_url": "string",
        "expires_at": "string"
      }
    },
    {
      "success": false,
      "error": {
        "code": "string",
        "message": "string",
        "details": "object"
      }
    }
  ]
}
```

**Field Descriptions:**
- **results**: Array of preview results matching the order of requests
- **success**: Whether this specific preview request succeeded
- **response**: Preview response for successful requests (same structure as single mode)
- **error**: Error information for failed requests (code, message, optional details)

### Preview Variant Structure

```typescript
{
  preview_id: string;            // Unique identifier for this preview variant
  renders: [{                    // Array of rendered pieces (most formats have one)
    render_id: string;           // Unique identifier for this rendered piece
    preview_url: string;         // URL to HTML page - can be embedded in iframe
    role: string;                // Semantic role: "primary", "companion", or descriptive custom string
    dimensions?: {               // Dimensions for this rendered piece (enables iframe sizing)
      width: number;             // Width in pixels
      height: number;            // Height in pixels
    };
    embedding?: {                // OPTIONAL: Security/embedding metadata
      recommended_sandbox?: string;  // e.g., "allow-scripts allow-same-origin"
      requires_https?: boolean;
      supports_fullscreen?: boolean;
      csp_policy?: string;
    };
  }];
  input: {                       // Input parameters that generated this variant
    name: string;                // Variant name (from request or auto-generated)
    macros?: object;             // Macro values applied
    context_description?: string; // Context description applied
  };
}
```

**Key Design Points:**
- Each preview variant can have **multiple rendered pieces** (for companion ads, multi-placement formats, adaptive formats)
- Most formats render as a single piece - the `renders` array will have one item
- Every `preview_url` returns an **HTML page** that can be embedded in an `<iframe>`
- The HTML page handles all rendering complexity (video players, audio players, images, interactive content)
- No client-side logic needed to determine how to render different preview types
- The `input` field echoes back the parameters used, making it easy to understand what each preview shows

**Multi-Piece Formats:**
Some formats render as multiple pieces in a single preview variant:
- **Companion ads**: Video + display banner (e.g., 30s video with 300x250 companion)
- **Adaptive formats**: Desktop + mobile + tablet variants from one manifest
- **Multi-placement**: Multiple sizes generated from a single creative
- **DOOH installations**: Multiple screens in a venue

Each rendered piece has:
- **role**: Semantic role (`"primary"`, `"companion"`, or descriptive strings for device variants)
- **dimensions**: Width and height for iframe sizing (especially important when multiple pieces have different sizes)
- **preview_url**: Separate iframe URL for rendering this piece

**Optional Fields:**
- **embedding**: Security metadata for safe iframe integration (sandbox policies, HTTPS requirements, CSP)
- **dimensions**: May be omitted for responsive formats where dimensions vary by viewport

## Examples

### Example 1: Basic Display Format with Multiple Devices

Request previews for desktop, mobile, and tablet:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "native_responsive"
  },
  "creative_manifest": {
    "format_id": {
      "agent_url": "https://creative.adcontextprotocol.org",
      "id": "native_responsive"
    },
    "assets": {
      "hero_image": {
        "asset_type": "image",
        "url": "https://cdn.example.com/hero.jpg",
        "width": 1200,
        "height": 627,
        "format": "jpg"
      },
      "headline": {
        "asset_type": "text",
        "content": "Veterinarian Recommended Nutrition"
      },
      "description": {
        "asset_type": "text",
        "content": "Real salmon as the #1 ingredient"
      },
      "cta_text": {
        "asset_type": "text",
        "content": "Learn More"
      }
    }
  },
  "inputs": [
    {
      "name": "Desktop",
      "macros": {
        "DEVICE_TYPE": "desktop"
      }
    },
    {
      "name": "Mobile",
      "macros": {
        "DEVICE_TYPE": "mobile"
      }
    },
    {
      "name": "Tablet",
      "macros": {
        "DEVICE_TYPE": "tablet"
      }
    }
  ]
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/abc123/desktop",
      "input": {
        "name": "Desktop",
        "macros": {
          "DEVICE_TYPE": "desktop",
          "CACHEBUSTER": "87654321"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/abc123/mobile",
      "input": {
        "name": "Mobile",
        "macros": {
          "DEVICE_TYPE": "mobile",
          "CACHEBUSTER": "87654321"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/abc123/tablet",
      "input": {
        "name": "Tablet",
        "macros": {
          "DEVICE_TYPE": "tablet",
          "CACHEBUSTER": "87654321"
        }
      }
    }
  ],
  "interactive_url": "https://creative-agent.example.com/preview/abc123/interactive",
  "expires_at": "2025-02-15T18:00:00Z"
}
```

Each `preview_url` returns an HTML page that renders the creative at the appropriate size and device context. Simply embed in an iframe:

```html
<iframe src="https://creative-agent.example.com/preview/abc123/desktop"
        width="1200" height="627" frameborder="0"></iframe>
```

### Example 2: Batch Preview - Multiple Creatives

Preview three different banner creatives in one API call:

```json
{
  "requests": [
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "display_300x250"
      },
      "creative_manifest": {
        "format_id": {
          "agent_url": "https://creative.adcontextprotocol.org",
          "id": "display_300x250"
        },
        "assets": {
          "image": {
            "asset_type": "image",
            "url": "https://cdn.example.com/banner-300x250-v1.jpg",
            "width": 300,
            "height": 250,
            "format": "jpg"
          }
        }
      }
    },
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "display_728x90"
      },
      "creative_manifest": {
        "format_id": {
          "agent_url": "https://creative.adcontextprotocol.org",
          "id": "display_728x90"
        },
        "assets": {
          "image": {
            "asset_type": "image",
            "url": "https://cdn.example.com/banner-728x90-v1.jpg",
            "width": 728,
            "height": 90,
            "format": "jpg"
          }
        }
      }
    },
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "video_30s_vast"
      },
      "creative_manifest": {
        "format_id": {
          "agent_url": "https://creative.adcontextprotocol.org",
          "id": "video_30s_vast"
        },
        "assets": {
          "vast_tag": {
            "asset_type": "vast_tag",
            "content": "<?xml version=\"1.0\"?><VAST version=\"4.2\">...</VAST>",
            "vast_version": "4.2"
          }
        }
      }
    }
  ]
}
```

Response contains results in the same order:

```json
{
  "results": [
    {
      "success": true,
      "response": {
        "previews": [
          {
            "preview_id": "prev_abc123",
            "renders": [
              {
                "render_id": "render_1",
                "preview_url": "https://creative-agent.example.com/preview/abc123",
                "role": "primary",
                "dimensions": {"width": 300, "height": 250}
              }
            ],
            "input": {
              "name": "Default",
              "macros": {"CACHEBUSTER": "12345678"}
            }
          }
        ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    },
    {
      "success": true,
      "response": {
        "previews": [
          {
            "preview_id": "prev_def456",
            "renders": [
              {
                "render_id": "render_2",
                "preview_url": "https://creative-agent.example.com/preview/def456",
                "role": "primary",
                "dimensions": {"width": 728, "height": 90}
              }
            ],
            "input": {
              "name": "Default",
              "macros": {"CACHEBUSTER": "12345678"}
            }
          }
        ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    },
    {
      "success": true,
      "response": {
        "previews": [
          {
            "preview_id": "prev_video789",
            "renders": [
              {
                "render_id": "render_3",
                "preview_url": "https://creative-agent.example.com/preview/video789",
                "role": "primary",
                "dimensions": {"width": 1920, "height": 1080}
              }
            ],
            "input": {
              "name": "Default",
              "macros": {"CACHEBUSTER": "87654321"}
            }
          }
        ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    }
  ]
}
```

**Key Benefits:**
- Single API call for 3 creatives (5-10x faster than 3 separate calls)
- Results returned in same order as requests
- Mix different formats in one batch (display + video)

### Example 3: Batch with HTML Output (Grid View)

Request HTML directly for 50 creatives to build a preview grid without 50 iframes:

```json
{
  "output_format": "html",
  "requests": [
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "display_300x250"
      },
      "creative_manifest": { /* Creative 1 */ }
    },
    {
      "format_id": {
        "agent_url": "https://creative.adcontextprotocol.org",
        "id": "display_300x250"
      },
      "creative_manifest": { /* Creative 2 */ }
    }
    // ... 48 more creatives
  ]
}
```

Response with HTML for direct embedding:

```json
{
  "results": [
    {
      "success": true,
      "response": {
        "previews": [
          {
            "preview_id": "prev_1",
            "renders": [
              {
                "render_id": "render_1",
                "preview_html": "<div class=\"creative-300x250\"><img src=\"https://...\"/><div class=\"headline\">Ad 1</div></div>",
                "role": "primary",
                "dimensions": {"width": 300, "height": 250}
              }
            ],
            "input": {"name": "Default", "macros": {"CACHEBUSTER": "123"}}
          }
        ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    },
    {
      "success": true,
      "response": {
        "previews": [
          {
            "preview_id": "prev_2",
            "renders": [
              {
                "render_id": "render_2",
                "preview_html": "<div class=\"creative-300x250\"><img src=\"https://...\"/><div class=\"headline\">Ad 2</div></div>",
                "role": "primary",
                "dimensions": {"width": 300, "height": 250}
              }
            ],
            "input": {"name": "Default", "macros": {"CACHEBUSTER": "456"}}
          }
        ],
        "expires_at": "2025-02-15T18:00:00Z"
      }
    }
    // ... 48 more results
  ]
}
```

Render in a grid:

```jsx
<div className="preview-grid">
  {results.map((result, idx) => (
    result.success && (
      <div
        key={idx}
        className="preview-item"
        dangerouslySetInnerHTML={{
          __html: result.response.previews[0].renders[0].preview_html
        }}
      />
    )
  ))}
</div>
```

**Performance:**
- No 50 iframe HTTP requests
- Faster page load (all HTML in one response)
- Better scrolling performance
- Easier to style with CSS Grid

### Example 4: Dynamic Creative with Context

Preview a dynamic creative with different geographic and device contexts:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "display_dynamic_300x250"
  },
  "creative_manifest": {
    "format_id": {
      "agent_url": "https://creative.adcontextprotocol.org",
      "id": "display_dynamic_300x250"
    },
    "assets": {
      "dynamic_endpoint": {
        "asset_type": "dynamic_endpoint",
        "url": "https://creative-agent.example.com/render/ctx-456",
        "supported_macros": ["COUNTRY", "CITY", "DEVICE_TYPE", "WEATHER"]
      },
      "fallback_image": {
        "asset_type": "image",
        "url": "https://cdn.example.com/fallback-300x250.jpg",
        "width": 300,
        "height": 250,
        "format": "jpg"
      }
    }
  },
  "inputs": [
    {
      "name": "NYC Mobile",
      "macros": {
        "COUNTRY": "US",
        "CITY": "New York",
        "DMA": "501",
        "DEVICE_TYPE": "mobile"
      }
    },
    {
      "name": "LA Desktop",
      "macros": {
        "COUNTRY": "US",
        "CITY": "Los Angeles",
        "DMA": "803",
        "DEVICE_TYPE": "desktop"
      }
    }
  ]
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/xyz789/nyc-mobile",
      "input": {
        "name": "NYC Mobile",
        "macros": {
          "COUNTRY": "US",
          "CITY": "New York",
          "DMA": "501",
          "DEVICE_TYPE": "mobile",
          "CACHEBUSTER": "12345678"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/xyz789/la-desktop",
      "input": {
        "name": "LA Desktop",
        "macros": {
          "COUNTRY": "US",
          "CITY": "Los Angeles",
          "DMA": "803",
          "DEVICE_TYPE": "desktop",
          "CACHEBUSTER": "12345678"
        }
      }
    }
  ],
  "interactive_url": "https://creative-agent.example.com/preview/xyz789/interactive",
  "expires_at": "2025-02-15T18:00:00Z"
}
```

### Example 3: AI-Generated Host Read Audio Ad

Preview an audio ad with AI-generated host reads for different podcast contexts:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "audio_host_read_30s"
  },
  "creative_manifest": {
    "format_id": {
      "agent_url": "https://creative.adcontextprotocol.org",
      "id": "audio_host_read_30s"
    },
    "assets": {
      "script_template": {
        "asset_type": "text",
        "content": "This episode brought to you by {{BRAND_NAME}}. {{PRODUCT_DESCRIPTION}}. Use code {{PROMO_CODE}} for 20% off."
      },
      "brand_voice": {
        "asset_type": "text",
        "content": "Friendly, enthusiastic, conversational. Target audience: health-conscious millennials."
      }
    },
    "metadata": {
      "brand_name": "VitaBoost",
      "product_description": "Premium vitamin subscription service"
    }
  },
  "inputs": [
    {
      "name": "Weather Podcast",
      "context_description": "Podcast host discussing weather patterns and seasonal changes, transitioning to ad break"
    },
    {
      "name": "Running Podcast",
      "context_description": "Podcast about marathon training and fitness, host just finished discussing nutrition for runners"
    },
    {
      "name": "News Podcast Morning",
      "context_description": "Morning news podcast, upbeat energy, discussing daily health headlines"
    }
  ]
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/audio123/weather",
      "input": {
        "name": "Weather Podcast",
        "context_description": "Podcast host discussing weather patterns and seasonal changes, transitioning to ad break",
        "macros": {
          "CONTENT_GENRE": "news",
          "CACHEBUSTER": "99887766"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/audio123/running",
      "input": {
        "name": "Running Podcast",
        "context_description": "Podcast about marathon training and fitness, host just finished discussing nutrition for runners",
        "macros": {
          "CONTENT_GENRE": "sports",
          "CACHEBUSTER": "99887766"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/audio123/morning-news",
      "input": {
        "name": "News Podcast Morning",
        "context_description": "Morning news podcast, upbeat energy, discussing daily health headlines",
        "macros": {
          "CONTENT_GENRE": "news",
          "CACHEBUSTER": "99887766"
        }
      }
    }
  ],
  "interactive_url": "https://creative-agent.example.com/preview/audio123/player",
  "expires_at": "2025-02-15T18:00:00Z"
}
```

Each `preview_url` returns an HTML page with an embedded audio player showing the AI-generated host read for that context.

### Example 4: Video with Multiple Geographic Contexts

Preview a video creative with geo-specific end cards:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "video_30s_vast"
  },
  "creative_manifest": {
    "format_id": {
      "agent_url": "https://creative.adcontextprotocol.org",
      "id": "video_30s_vast"
    },
    "assets": {
      "vast_tag": {
        "asset_type": "vast_tag",
        "content": "<?xml version=\"1.0\"?><VAST version=\"4.2\">...</VAST>",
        "vast_version": "4.2"
      }
    }
  },
  "inputs": [
    {
      "name": "US Northeast",
      "macros": {
        "COUNTRY": "US",
        "REGION": "NY",
        "DMA": "501"
      }
    },
    {
      "name": "UK London",
      "macros": {
        "COUNTRY": "GB",
        "REGION": "ENG",
        "CITY": "London"
      }
    }
  ]
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/video456/us-ne",
      "input": {
        "name": "US Northeast",
        "macros": {
          "COUNTRY": "US",
          "REGION": "NY",
          "DMA": "501",
          "CACHEBUSTER": "11223344"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/video456/uk-london",
      "input": {
        "name": "UK London",
        "macros": {
          "COUNTRY": "GB",
          "REGION": "ENG",
          "CITY": "London",
          "CACHEBUSTER": "11223344"
        }
      }
    }
  ],
  "interactive_url": "https://creative-agent.example.com/preview/video456/player",
  "expires_at": "2025-02-15T18:00:00Z"
}
```

Each `preview_url` returns an HTML page with an embedded video player showing the geo-specific variant.

### Example 4: Dynamic Creative with Template Variables

Preview a dynamic creative that uses template variables for personalization:

```json
{
  "format_id": {
    "agent_url": "https://creative.adcontextprotocol.org",
    "id": "native_responsive"
  },
  "creative_manifest": {
    "format_id": {
      "agent_url": "https://creative.adcontextprotocol.org",
      "id": "native_responsive"
    },
    "assets": {
      "headline": {
        "asset_type": "text",
        "content": "Discover {PRODUCT_NAME}"
      },
      "description": {
        "asset_type": "text",
        "content": "{PRODUCT_DESCRIPTION}"
      },
      "main_image": {
        "asset_type": "image",
        "url": "https://cdn.acmecorp.com/hero.jpg"
      },
      "cta": {
        "asset_type": "text",
        "content": "Shop Now"
      }
    }
  },
  "inputs": [
    {
      "name": "Product A",
      "macros": {
        "PRODUCT_NAME": "Widget Pro 2024",
        "PRODUCT_DESCRIPTION": "Premium quality you can trust"
      }
    },
    {
      "name": "Product B",
      "macros": {
        "PRODUCT_NAME": "Widget Lite",
        "PRODUCT_DESCRIPTION": "Affordable excellence for everyone"
      }
    }
  ]
}
```

Response:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/dynamic123/a",
      "input": {
        "name": "Product A",
        "macros": {
          "PRODUCT_NAME": "Widget Pro 2024",
          "PRODUCT_DESCRIPTION": "Premium quality you can trust"
        }
      }
    },
    {
      "preview_url": "https://creative-agent.example.com/preview/dynamic123/b",
      "input": {
        "name": "Product B",
        "macros": {
          "PRODUCT_NAME": "Widget Lite",
          "PRODUCT_DESCRIPTION": "Affordable excellence for everyone"
        }
      }
    }
  ],
  "interactive_url": "https://creative-agent.example.com/preview/dynamic123/interactive",
  "expires_at": "2025-02-15T18:00:00Z"
}
```

### Example 5: Video Preview with Optimization Hints

Response showing optional hints and embedding metadata:

```json
{
  "previews": [
    {
      "preview_url": "https://creative-agent.example.com/preview/video789",
      "input": {
        "name": "CTV Video",
        "macros": {
          "DEVICE_TYPE": "ctv"
        }
      },
      "hints": {
        "primary_media_type": "video",
        "estimated_dimensions": {
          "width": 1920,
          "height": 1080
        },
        "estimated_duration_seconds": 30,
        "contains_audio": true,
        "requires_interaction": false
      },
      "embedding": {
        "recommended_sandbox": "allow-scripts allow-same-origin",
        "requires_https": true,
        "supports_fullscreen": true,
        "csp_policy": "default-src 'self' https://cdn.example.com"
      }
    }
  ],
  "expires_at": "2025-02-15T18:00:00Z"
}
```

**Using hints for optimization:**

```javascript
// Client can use hints to optimize iframe setup
const preview = response.previews[0];

if (preview.hints?.primary_media_type === "video") {
  // Preload video codec
  document.createElement('link').rel = 'preload';
}

if (preview.hints?.estimated_dimensions) {
  // Size iframe appropriately
  iframe.width = preview.hints.estimated_dimensions.width;
  iframe.height = preview.hints.estimated_dimensions.height;
}

if (preview.hints?.contains_audio) {
  // Warn user about autoplay policies
  showAutoplayWarning();
}
```

**Using embedding metadata for security:**

```javascript
// Apply recommended security policies
if (preview.embedding?.recommended_sandbox) {
  iframe.sandbox = preview.embedding.recommended_sandbox;
}

if (preview.embedding?.requires_https && !preview.preview_url.startsWith('https:')) {
  console.warn('Preview should be served over HTTPS');
}

if (preview.embedding?.supports_fullscreen) {
  iframe.allowFullscreen = true;
}
```

## Usage Notes

- **Preview URLs are Always HTML**: Every `preview_url` returns an HTML page that can be embedded in an iframe - no client-side rendering logic needed
- **One Preview per Input**: If you provide 3 inputs, you get 3 previews. If you provide no inputs, you get 1 default preview.
- **Input Echo**: The `input` field echoes back the parameters used to generate each preview, making it clear what each variant represents
- **Optional Hints**: Creative agents MAY provide optimization hints. Clients MUST support HTML rendering regardless of whether hints are present.
- **Optional Embedding Metadata**: Provides guidance for secure iframe integration, but clients should apply their own security policies as needed.
- **Preview Expiration**: Preview links typically expire within 24-48 hours
- **Macro Defaults**: If macro values aren't provided, creative agents use sensible defaults
- **Interactive Testing Page**: The optional `interactive_url` provides advanced testing with controls to modify macros in real-time
- **Format Requirements**: Creative manifest must include all required assets for the format

## Use Cases

### Device Preview Variants

Test responsive designs across devices:
```json
"inputs": [
  {"name": "Desktop", "macros": {"DEVICE_TYPE": "desktop"}},
  {"name": "Mobile", "macros": {"DEVICE_TYPE": "mobile"}},
  {"name": "CTV", "macros": {"DEVICE_TYPE": "ctv"}}
]
```

### Dark/Light Mode Variants

For formats supporting appearance modes:
```json
"inputs": [
  {"name": "Light mode", "macros": {"APPEARANCE": "light"}},
  {"name": "Dark mode", "macros": {"APPEARANCE": "dark"}}
]
```

### Geographic Variants

Test location-specific creative elements:
```json
"inputs": [
  {"name": "NYC", "macros": {"CITY": "New York", "DMA": "501"}},
  {"name": "LA", "macros": {"CITY": "Los Angeles", "DMA": "803"}},
  {"name": "Chicago", "macros": {"CITY": "Chicago", "DMA": "602"}}
]
```

### AI-Generated Content Variants

For dynamic audio or text generation:
```json
"inputs": [
  {
    "name": "Morning commute",
    "context_description": "User commuting to work, listening to news"
  },
  {
    "name": "Evening relaxation",
    "context_description": "User relaxing at home after work"
  }
]
```

### Privacy Compliance Testing

Test creative behavior with different privacy settings:
```json
"inputs": [
  {"name": "Full consent", "macros": {"GDPR": "1", "GDPR_CONSENT": "CPc7TgP..."}},
  {"name": "No consent", "macros": {"GDPR": "1", "GDPR_CONSENT": ""}},
  {"name": "LAT enabled", "macros": {"LIMIT_AD_TRACKING": "1"}}
]
```

## Implementation Considerations

### For Creative Agents

Creative agents implementing `preview_creative` should:

#### Required Implementation

1. **Return HTML Pages**: Every `preview_url` MUST return a complete HTML page that renders the creative
   ```html
   <!DOCTYPE html>
   <html>
     <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>Preview: {variant_name}</title>
     </head>
     <body style="margin:0; padding:0;">
       <!-- Creative rendering here -->
     </body>
   </html>
   ```

2. **Handle All Media Types**: Embed appropriate players within the HTML page
   - **Images**: Use `<img>` tags with appropriate sizing
   - **Video**: Embed `<video>` player or iframe VAST player
   - **Audio**: Embed `<audio>` player with controls
   - **Interactive**: Embed canvas, WebGL, or interactive HTML

3. **Echo Input Parameters**: Return the exact `input` object (with defaults filled in)

4. **One Preview per Input**: Generate exactly one preview variant per input set provided. If no inputs, generate one default preview.

5. **Validate Manifest**: Ensure all required assets for the format are present before rendering

6. **Apply Macros**: Replace macro placeholders with provided or default values

7. **Security**: Sandbox creative rendering to prevent malicious code execution
   - Implement Content Security Policy headers
   - Sanitize user-provided creative content
   - Isolate preview rendering from internal systems

8. **Performance**: Generate previews quickly (< 10 seconds for multiple variants)

9. **Expiration**: Set reasonable expiration times (24-48 hours recommended) and clean up old previews

#### Optional Enhancements

10. **Provide Hints**: Include `hints` object for client optimization
    ```json
    "hints": {
      "primary_media_type": "video",
      "estimated_dimensions": {"width": 1920, "height": 1080},
      "estimated_duration_seconds": 30,
      "contains_audio": true,
      "requires_interaction": false
    }
    ```

11. **Provide Embedding Metadata**: Include `embedding` object for security guidance
    ```json
    "embedding": {
      "recommended_sandbox": "allow-scripts allow-same-origin",
      "requires_https": true,
      "supports_fullscreen": true,
      "csp_policy": "default-src 'self' https://cdn.example.com"
    }
    ```

12. **Responsive Design**: HTML pages SHOULD adapt gracefully to different iframe sizes

13. **Accessibility**: Include ARIA labels and semantic HTML where feasible (WCAG 2.1 Level AA)

### For Buyers

When requesting previews:

1. **Simple Embedding**: Just iframe the `preview_url` - no conditional rendering logic needed
2. **Request What You Need**: Use `inputs` array to specify the exact scenarios you want to see (don't rely on default variants if you have specific needs)
3. **Check Input Echo**: Review the `input` field in each preview to confirm macros were applied as expected
4. **Share with Clients**: Preview URLs are shareable links - perfect for sending to clients for approval
5. **Test Key Scenarios**: Request previews for important device, geographic, and context combinations
6. **Use Interactive URL**: For advanced testing, the `interactive_url` lets you modify macros in real-time

### For Publishers

When integrating creative agent previews:

1. **Consistent HTML Output**: Always return HTML pages from preview URLs, regardless of creative type
2. **Responsive Design**: Preview pages should adapt to iframe dimensions appropriately
3. **Document Macros**: Specify which macros your formats support via `supported_macros` in format definitions
4. **Set Expectations**: Clarify how preview rendering may differ from production (e.g., watermarks, debug info)
5. **Interactive Testing**: Consider providing an `interactive_url` with advanced testing controls
