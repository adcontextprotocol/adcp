---
title: update_media_buy
sidebar_position: 8
testable: true
---

# update_media_buy

Modify an existing media buy using PATCH semantics. Supports campaign-level and package-level updates.

**Response Time**: Instant to days (status: `completed`, `working` < 120s, or `submitted` for manual review)

**PATCH Semantics**: Only specified fields are updated; omitted fields remain unchanged.

**Request Schema**: [`/schemas/v1/media-buy/update-media-buy-request.json`](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-request.json)
**Response Schema**: [`/schemas/v1/media-buy/update-media-buy-response.json`](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-response.json)

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `media_buy_id` | string | Yes* | Publisher's media buy identifier to update |
| `buyer_ref` | string | Yes* | Your reference for the media buy to update |
| `start_time` | string | No | Updated campaign start time |
| `end_time` | string | No | Updated campaign end time |
| `active` | boolean | No | Pause/resume entire media buy |
| `packages` | PackageUpdate[] | No | Package-level updates (see below) |

*Either `media_buy_id` OR `buyer_ref` is required (not both)

### Package Update Object

| Parameter | Type | Description |
|-----------|------|-------------|
| `package_id` | string | Publisher's package identifier to update |
| `buyer_ref` | string | Your reference for the package to update |
| `active` | boolean | Pause/resume specific package |
| `budget` | number | Updated budget allocation |
| `pacing` | string | Updated pacing strategy |
| `bid_price` | number | Updated bid price (auction products only) |
| `targeting_overlay` | TargetingOverlay | Updated targeting restrictions |
| `creative_ids` | string[] | Replace assigned creatives (simple array of IDs) |
| `creatives` | Creative[] | Upload and assign new creatives inline (includes assets) |
| `creative_assignments` | CreativeAssignment[] | Replace creatives with weights and placement targeting |

*Either `package_id` OR `buyer_ref` is required for each package update

**Creative Management Options**:
- Use `creative_ids` for simple creative swaps (creatives must already exist in library)
- Use `creatives` to upload new assets and assign them in one operation
- Use `creative_assignments` for granular control over weights and placement targeting

## Response

Returns updated media buy with status:

| Field | Description |
|-------|-------------|
| `media_buy_id` | Media buy identifier |
| `status` | Update status (`"completed"`, `"working"`, `"submitted"`) |
| `packages` | Updated packages with new values |
| `message` | Human-readable update description |

See [schema](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-response.json) for complete field list.

## Common Scenarios

**Note**: These examples use `buyer_ref` to reference media buys and packages by your own identifiers. You can also use the publisher's `media_buy_id` and `package_id` if you prefer.

### Pause Campaign

```javascript
import { testAgent } from '@adcp/client/testing';

// Pause entire campaign using your reference
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  active: false
});

console.log(`Campaign paused`);
```

### Update Package Budget

```javascript
import { testAgent } from '@adcp/client/testing';

// Increase budget for specific package using your reference
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    budget: 25000  // Increased from 15000
  }]
});

console.log(`Package budget updated to ${result.packages[0].budget}`);
```

### Change Campaign Dates

```javascript
import { testAgent } from '@adcp/client/testing';

// Extend campaign end date
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  end_time: '2025-09-30T23:59:59Z'  // Extended from original end date
});

console.log(`Campaign extended to: ${result.end_time}`);
```

### Update Targeting

```javascript
import { testAgent } from '@adcp/client/testing';

// Add geographic restrictions to package
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    targeting_overlay: {
      geo_country_any_of: ['US', 'CA'],
      geo_region_any_of: ['CA', 'NY', 'TX', 'ON', 'QC']
    }
  }]
});

console.log('Targeting updated successfully');
```

### Replace Creatives

```javascript
import { testAgent } from '@adcp/client/testing';

// Swap out creative assets
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    creative_ids: ['creative_video_002', 'creative_display_002']
  }]
});

console.log(`Assigned ${result.packages[0].creative_ids.length} new creatives`);
```

### Upload and Assign Creatives Inline

Upload new creative assets and assign them in one operation:

<CodeGroup>

```javascript JavaScript
import { testAgent } from '@adcp/client/testing';

// Upload new creative and assign it to package
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    creatives: [{
      creative_id: 'creative_video_003',
      name: 'New Product Video 30s',
      format_id: {
        agent_url: 'https://creative.adcontextprotocol.org',
        id: 'video_standard_30s'
      },
      assets: {
        video: {
          url: 'https://cdn.example.com/new-product-30s.mp4',
          width: 1920,
          height: 1080,
          duration_ms: 30000
        }
      }
    }]
  }]
});

console.log('Uploaded and assigned new creative');
```

```python Python
import asyncio
from adcp import test_agent

async def main():
    # Upload new creative and assign it to package
    result = await test_agent.simple.update_media_buy(
        buyer_ref='mb_summer_2025',
        packages=[{
            'buyer_ref': 'pkg_premium',
            'creatives': [{
                'creative_id': 'creative_video_003',
                'name': 'New Product Video 30s',
                'format_id': {
                    'agent_url': 'https://creative.adcontextprotocol.org',
                    'id': 'video_standard_30s'
                },
                'assets': {
                    'video': {
                        'url': 'https://cdn.example.com/new-product-30s.mp4',
                        'width': 1920,
                        'height': 1080,
                        'duration_ms': 30000
                    }
                }
            }]
        }]
    )

    print('Uploaded and assigned new creative')

asyncio.run(main())
```

</CodeGroup>

### Update Creative Weights and Placement Targeting

Control creative rotation weights and placement targeting:

<CodeGroup>

```javascript JavaScript
import { testAgent } from '@adcp/client/testing';

// Set creative rotation weights and placement targeting
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    creative_assignments: [
      {
        creative_id: 'creative_video_001',
        weight: 70,  // 70% of impressions
        placement_ids: ['placement_premium_video']
      },
      {
        creative_id: 'creative_video_002',
        weight: 30,  // 30% of impressions
        placement_ids: ['placement_premium_video']
      }
    ]
  }]
});

console.log('Updated creative rotation and placement targeting');
```

```python Python
import asyncio
from adcp import test_agent

async def main():
    # Set creative rotation weights and placement targeting
    result = await test_agent.simple.update_media_buy(
        buyer_ref='mb_summer_2025',
        packages=[{
            'buyer_ref': 'pkg_premium',
            'creative_assignments': [
                {
                    'creative_id': 'creative_video_001',
                    'weight': 70,  # 70% of impressions
                    'placement_ids': ['placement_premium_video']
                },
                {
                    'creative_id': 'creative_video_002',
                    'weight': 30,  # 30% of impressions
                    'placement_ids': ['placement_premium_video']
                }
            ]
        }]
    )

    print('Updated creative rotation and placement targeting')

asyncio.run(main())
```

</CodeGroup>

### Upload Creative with Weight and Placement

Upload new creative with rotation weight and placement targeting:

<CodeGroup>

```javascript JavaScript
import { testAgent } from '@adcp/client/testing';

// Upload creative with weight and placement configuration
const result = await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    creatives: [{
      creative_id: 'creative_video_004',
      name: 'Featured Product Video',
      format_id: {
        agent_url: 'https://creative.adcontextprotocol.org',
        id: 'video_standard_30s'
      },
      assets: {
        video: {
          url: 'https://cdn.example.com/featured-30s.mp4',
          width: 1920,
          height: 1080,
          duration_ms: 30000
        }
      },
      weight: 50,
      placement_ids: ['placement_premium_video', 'placement_standard_video']
    }]
  }]
});

console.log('Uploaded creative with targeting configuration');
```

```python Python
import asyncio
from adcp import test_agent

async def main():
    # Upload creative with weight and placement configuration
    result = await test_agent.simple.update_media_buy(
        buyer_ref='mb_summer_2025',
        packages=[{
            'buyer_ref': 'pkg_premium',
            'creatives': [{
                'creative_id': 'creative_video_004',
                'name': 'Featured Product Video',
                'format_id': {
                    'agent_url': 'https://creative.adcontextprotocol.org',
                    'id': 'video_standard_30s'
                },
                'assets': {
                    'video': {
                        'url': 'https://cdn.example.com/featured-30s.mp4',
                        'width': 1920,
                        'height': 1080,
                        'duration_ms': 30000
                    }
                },
                'weight': 50,
                'placement_ids': ['placement_premium_video', 'placement_standard_video']
            }]
        }]
    )

    print('Uploaded creative with targeting configuration')

asyncio.run(main())
```

</CodeGroup>

## What Can Be Updated

### Campaign-Level Updates

✅ **Can update:**
- Start/end times (subject to seller approval)
- Campaign status (active/paused/cancelled)
- Reporting webhook configuration

❌ **Cannot update:**
- Media buy ID
- Buyer reference
- Brand manifest
- Original package product IDs

### Package-Level Updates

✅ **Can update:**
- Budget allocation
- Pacing strategy
- Bid prices (auction products)
- Targeting overlays
- Creative assignments
- Package status

❌ **Cannot update:**
- Package ID
- Product ID
- Pricing option ID
- Format IDs (creatives must match existing formats)

## Update Approval

Some updates require seller approval and return `status: "submitted"`:

- **Significant budget increases** (threshold varies by seller)
- **Date range changes** affecting inventory availability
- **Targeting changes** that alter campaign scope
- **Creative changes** requiring policy review

When approval is needed:
```javascript
if (result.status === 'submitted') {
  console.log('Update requires approval:', result.message);
  // Set up status monitoring
}
```

## PATCH Semantics

Only specified fields are updated:

```javascript
// This update ONLY changes budget - all other fields unchanged
await testAgent.updateMediaBuy({
  buyer_ref: 'mb_summer_2025',
  packages: [{
    buyer_ref: 'pkg_premium',
    budget: 25000
  }]
});
```

To replace arrays (like creative_ids), provide the complete new array:

```javascript
// Replaces ALL creatives with new list
packages: [{
  buyer_ref: 'pkg_premium',
  creative_ids: ['creative_video_002', 'creative_display_002']
}]
```

## Error Handling

| Error Code | Description | Resolution |
|------------|-------------|------------|
| `AUTH_REQUIRED` | Authentication needed | Provide credentials |
| `INVALID_REQUEST` | Invalid field values | Check request against schema |
| `MEDIA_BUY_NOT_FOUND` | Media buy doesn't exist | Verify media_buy_id |
| `PACKAGE_NOT_FOUND` | Package doesn't exist | Verify package_id |
| `UPDATE_NOT_ALLOWED` | Field cannot be changed | See "What Can Be Updated" above |
| `POLICY_VIOLATION` | Update violates content policy | Review policy message |
| `BUDGET_INSUFFICIENT` | New budget below minimum | Increase budget amount |

## Async Workflows

Updates may be asynchronous, especially with seller approval:

```javascript
const result = await agent.updateMediaBuy({...});

if (result.status === 'working') {
  // Poll for completion after a few seconds
  await new Promise(resolve => setTimeout(resolve, 5000));
  // Check status via protocol-specific mechanism
}

if (result.status === 'submitted') {
  // Manual approval required (hours to days)
  console.log('Awaiting seller approval:', result.message);
}
```

See [Task Management](/docs/protocols/task-management) for protocol-specific async patterns.

## Best Practices

**1. Use Precise Updates**
Update only what needs to change - don't resend unchanged values.

**2. Budget Increases**
Small incremental increases are more likely to be auto-approved than large jumps.

**3. Pause Before Major Changes**
Pause campaigns before making significant targeting or creative changes.

**4. Test with Small Changes**
Test update workflows with minor changes before critical campaign modifications.

**5. Monitor Status**
Always check response status and message for approval requirements or errors.

## Next Steps

After updating a media buy:

1. **Verify Changes**: Use [`get_media_buy_delivery`](/docs/media-buy/task-reference/get_media_buy_delivery) to confirm updates
2. **Upload New Creatives**: Use [`sync_creatives`](/docs/media-buy/task-reference/sync_creatives) if creative_ids changed
3. **Monitor Performance**: Track impact of changes on campaign metrics
4. **Optimize Further**: Use [`provide_performance_feedback`](/docs/media-buy/task-reference/provide_performance_feedback) for ongoing optimization

## Learn More

- [Media Buy Lifecycle](/docs/media-buy/media-buys/) - Complete campaign workflow
- [Targeting](/docs/media-buy/advanced-topics/targeting) - Targeting overlays and restrictions
- [Task Management](/docs/protocols/task-management) - Async patterns and status checking
- [create_media_buy](/docs/media-buy/task-reference/create_media_buy) - Initial campaign creation
