---
title: update_media_buy
sidebar_position: 8
---

# update_media_buy

Modify an existing media buy using PATCH semantics. Supports campaign-level and package-level updates.

**Response Time**: Instant to days (status: `completed`, `working` < 120s, or `submitted` for manual review)

**PATCH Semantics**: Only specified fields are updated; omitted fields remain unchanged.

**Request Schema**: [`/schemas/v1/media-buy/update-media-buy-request.json`](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-request.json)
**Response Schema**: [`/schemas/v1/media-buy/update-media-buy-response.json`](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-response.json)

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `media_buy_id` | string | Yes | Media buy identifier to update |
| `start_time` | string | No | Updated campaign start time |
| `end_time` | string | No | Updated campaign end time |
| `status` | string | No | Change status (`"active"`, `"paused"`, `"cancelled"`) |
| `packages` | PackageUpdate[] | No | Package-level updates (see below) |
| `reporting_webhook` | ReportingWebhook | No | Update or add webhook configuration |

### Package Update Object

| Parameter | Type | Description |
|-----------|------|-------------|
| `package_id` | string | Package identifier to update |
| `status` | string | Package status (`"active"`, `"paused"`, `"cancelled"`) |
| `budget` | number | Updated budget allocation |
| `pacing` | string | Updated pacing strategy |
| `bid_price` | number | Updated bid price (auction products only) |
| `targeting_overlay` | TargetingOverlay | Updated targeting restrictions |
| `creative_ids` | string[] | Replace assigned creatives |

## Response

Returns updated media buy with status:

| Field | Description |
|-------|-------------|
| `media_buy_id` | Media buy identifier |
| `status` | Update status (`"completed"`, `"working"`, `"submitted"`) |
| `packages` | Updated packages with new values |
| `message` | Human-readable update description |

See [schema](https://adcontextprotocol.org/schemas/v1/media-buy/update-media-buy-response.json) for complete field list.

## Common Scenarios

### Pause Campaign

```javascript
import { ADCPMultiAgentClient } from '@adcp/client';

const client = new ADCPMultiAgentClient([{
  id: 'test-agent',
  agent_uri: 'https://test-agent.adcontextprotocol.org/mcp',
  protocol: 'mcp',
  auth: {
    type: 'bearer',
    token: '1v8tAhASaUYYp4odoQ1PnMpdqNaMiTrCRqYo9OJp6IQ'
  }
}]);

const agent = client.agent('test-agent');

// Pause entire campaign
const result = await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  status: 'paused'
});

console.log(`Campaign paused: ${result.status}`);
```

### Update Package Budget

```javascript
// Increase budget for specific package
const result = await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  packages: [{
    package_id: 'pkg_67890',
    budget: 25000  // Increased from 15000
  }]
});

console.log(`Package budget updated: ${result.packages[0].budget}`);
```

### Change Campaign Dates

```javascript
// Extend campaign end date
const result = await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  end_time: '2025-03-31T23:59:59Z'  // Extended from original end date
});

console.log(`Campaign extended to: ${result.end_time}`);
```

### Update Targeting

```javascript
// Add geographic restrictions to package
const result = await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  packages: [{
    package_id: 'pkg_67890',
    targeting_overlay: {
      geo_country_any_of: ['US', 'CA'],  // Expanded from US-only
      geo_region_any_of: ['CA', 'NY', 'TX', 'ON', 'QC']
    }
  }]
});

console.log('Targeting updated successfully');
```

### Replace Creatives

```javascript
// Swap out creative assets
const result = await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  packages: [{
    package_id: 'pkg_67890',
    creative_ids: ['creative_new_1', 'creative_new_2']  // Replace existing
  }]
});

console.log(`Assigned ${result.packages[0].creative_ids.length} new creatives`);
```

## What Can Be Updated

### Campaign-Level Updates

✅ **Can update:**
- Start/end times (subject to seller approval)
- Campaign status (active/paused/cancelled)
- Reporting webhook configuration

❌ **Cannot update:**
- Media buy ID
- Buyer reference
- Brand manifest
- Original package product IDs

### Package-Level Updates

✅ **Can update:**
- Budget allocation
- Pacing strategy
- Bid prices (auction products)
- Targeting overlays
- Creative assignments
- Package status

❌ **Cannot update:**
- Package ID
- Product ID
- Pricing option ID
- Format IDs (creatives must match existing formats)

## Update Approval

Some updates require seller approval and return `status: "submitted"`:

- **Significant budget increases** (threshold varies by seller)
- **Date range changes** affecting inventory availability
- **Targeting changes** that alter campaign scope
- **Creative changes** requiring policy review

When approval is needed:
```javascript
if (result.status === 'submitted') {
  console.log('Update requires approval:', result.message);
  // Set up status monitoring
}
```

## PATCH Semantics

Only specified fields are updated:

```javascript
// This update ONLY changes budget - all other fields unchanged
await agent.updateMediaBuy({
  media_buy_id: 'mb_12345',
  packages: [{
    package_id: 'pkg_67890',
    budget: 25000
  }]
});
```

To replace arrays (like creative_ids), provide the complete new array:

```javascript
// Replaces ALL creatives with new list
packages: [{
  package_id: 'pkg_67890',
  creative_ids: ['new_creative_1', 'new_creative_2']
}]
```

## Error Handling

| Error Code | Description | Resolution |
|------------|-------------|------------|
| `AUTH_REQUIRED` | Authentication needed | Provide credentials |
| `INVALID_REQUEST` | Invalid field values | Check request against schema |
| `MEDIA_BUY_NOT_FOUND` | Media buy doesn't exist | Verify media_buy_id |
| `PACKAGE_NOT_FOUND` | Package doesn't exist | Verify package_id |
| `UPDATE_NOT_ALLOWED` | Field cannot be changed | See "What Can Be Updated" above |
| `POLICY_VIOLATION` | Update violates content policy | Review policy message |
| `BUDGET_INSUFFICIENT` | New budget below minimum | Increase budget amount |

## Async Workflows

Updates may be asynchronous, especially with seller approval:

```javascript
const result = await agent.updateMediaBuy({...});

if (result.status === 'working') {
  // Poll for completion after a few seconds
  await new Promise(resolve => setTimeout(resolve, 5000));
  // Check status via protocol-specific mechanism
}

if (result.status === 'submitted') {
  // Manual approval required (hours to days)
  console.log('Awaiting seller approval:', result.message);
}
```

See [Task Management](/docs/protocols/task-management) for protocol-specific async patterns.

## Best Practices

**1. Use Precise Updates**
Update only what needs to change - don't resend unchanged values.

**2. Budget Increases**
Small incremental increases are more likely to be auto-approved than large jumps.

**3. Pause Before Major Changes**
Pause campaigns before making significant targeting or creative changes.

**4. Test with Small Changes**
Test update workflows with minor changes before critical campaign modifications.

**5. Monitor Status**
Always check response status and message for approval requirements or errors.

## Next Steps

After updating a media buy:

1. **Verify Changes**: Use [`get_media_buy_delivery`](/docs/media-buy/task-reference/get_media_buy_delivery) to confirm updates
2. **Upload New Creatives**: Use [`sync_creatives`](/docs/media-buy/task-reference/sync_creatives) if creative_ids changed
3. **Monitor Performance**: Track impact of changes on campaign metrics
4. **Optimize Further**: Use [`provide_performance_feedback`](/docs/media-buy/task-reference/provide_performance_feedback) for ongoing optimization

## Learn More

- [Media Buy Lifecycle](/docs/media-buy/media-buys/) - Complete campaign workflow
- [Targeting](/docs/media-buy/advanced-topics/targeting) - Targeting overlays and restrictions
- [Task Management](/docs/protocols/task-management) - Async patterns and status checking
- [create_media_buy](/docs/media-buy/task-reference/create_media_buy) - Initial campaign creation
