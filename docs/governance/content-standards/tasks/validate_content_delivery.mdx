---
title: validate_content_delivery
sidebar_position: 4
---

# validate_content_delivery

Validate delivery records against content safety policies. Designed for batch auditing of where ads were actually delivered.

**Response time**: < 10s (batch of 10,000 records)

## Data Flow

Delivery validation follows the same path as delivery reporting:

```mermaid
sequenceDiagram
    participant Seller as Seller Agent
    participant Buyer as Buyer Agent
    participant Verifier as Verification Agent

    Seller->>Buyer: Delivery records (via get_media_buy_delivery)
    Note over Buyer: Buyer aggregates delivery data
    Buyer->>Verifier: validate_content_delivery (sampled records)
    Verifier-->>Buyer: Validation results
    Note over Buyer: Buyer tracks compliance
```

**Why through the buyer?**

- The **buyer** owns the media buy and knows which `standards_id` applies
- The **buyer** aggregates delivery data from multiple sellers
- The **buyer** is accountable for brand safety compliance
- The **verification agent** works on behalf of the buyer

Sellers send delivery records to buyers via `get_media_buy_delivery`. The buyer then samples and validates against the verification agent. This keeps the seller's responsibility simple: report what was delivered.

## Request

**Schema**: [validate-content-delivery-request.json](https://adcontextprotocol.org/schemas/v2/content-standards/validate-content-delivery-request.json)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `standards_id` | string | Yes | Standards configuration to validate against |
| `media_buy_id` | string | No | Media buy these records belong to (for context) |
| `records` | array | Yes | Delivery records to validate (max 10,000) |
| `feature_ids` | array | No | Specific features to evaluate (defaults to all) |
| `include_passed` | boolean | No | Include passed records in results (default: true) |

### Delivery Record

```json
{
  "record_id": "imp_12345",
  "timestamp": "2025-01-15T10:30:00Z",
  "media_buy_id": "mb_nike_reddit_q1",
  "artifact": {
    "property_id": {"type": "domain", "value": "example.com"},
    "artifact_id": "article_12345",
    "assets": [
      {"type": "text", "role": "title", "content": "Article Title"}
    ]
  },
  "creative_id": "creative_abc"
}
```

## Response

**Schema**: [validate-content-delivery-response.json](https://adcontextprotocol.org/schemas/v2/content-standards/validate-content-delivery-response.json)

### Success Response

```json
{
  "summary": {
    "total_records": 1000,
    "passed_records": 950,
    "failed_records": 50,
    "total_features": 5000,
    "passed_features": 4750,
    "failed_features": 250
  },
  "results": [
    {
      "record_id": "imp_12345",
      "features": [
        {
          "feature_id": "brand_safety",
          "status": "passed",
          "value": "safe"
        },
        {
          "feature_id": "competitor_adjacency",
          "status": "passed",
          "value": false
        }
      ]
    },
    {
      "record_id": "imp_12346",
      "features": [
        {
          "feature_id": "brand_safety",
          "status": "failed",
          "value": "high_risk",
          "message": "Content contains violence"
        },
        {
          "feature_id": "competitor_adjacency",
          "status": "passed",
          "value": false
        }
      ]
    }
  ]
}
```

## Use Cases

### Post-Campaign Audit

```python
def audit_campaign_delivery(campaign_id, standards_id, content_standards_agent):
    """Audit all delivery records from a campaign."""
    # Fetch delivery records from your ad server
    records = fetch_delivery_records(campaign_id)

    # Validate in batches
    batch_size = 10000
    all_results = []

    for i in range(0, len(records), batch_size):
        batch = records[i:i + batch_size]
        response = content_standards_agent.validate_content_delivery(
            standards_id=standards_id,
            records=batch
        )
        all_results.extend(response["results"])

    return all_results
```

### Real-Time Monitoring Sample

```python
import random

def sample_and_validate(records, standards_id, sample_size=1000):
    """Validate a random sample for real-time monitoring."""
    sample = random.sample(records, min(sample_size, len(records)))
    return content_standards_agent.validate_content_delivery(
        standards_id=standards_id,
        records=sample
    )
```

### Filter for Issues Only

```python
# Only get failed records to reduce response size
response = content_standards_agent.validate_content_delivery(
    standards_id="nike_emea_safety",
    records=delivery_records,
    include_passed=False  # Only return failures
)

for result in response["results"]:
    print(f"Issue with {result['record_id']}")
    for feature in result["features"]:
        if feature["status"] == "failed":
            print(f"  - {feature['feature_id']}: {feature['message']}")
```

## Related Tasks

- [list_content_features](/docs/governance/content-standards/tasks/list_content_features) - Discover available features
- [calibrate_content](/docs/governance/content-standards/tasks/calibrate_content) - Collaborative calibration dialogue
- [get_content_standards](/docs/governance/content-standards/tasks/get_content_standards) - Retrieve the policies
