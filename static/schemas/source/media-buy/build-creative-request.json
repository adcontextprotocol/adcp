{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/media-buy/build-creative-request.json",
  "title": "Build Creative Request",
  "description": "Request to transform, generate, or refine a creative manifest. Takes a source manifest (which may be minimal for pure generation), a generated_creative_ref referencing a previous output, or both, and produces a target manifest in the specified format.",
  "type": "object",
  "properties": {
    "message": {
      "type": "string",
      "description": "Natural language instructions for the transformation or generation. For pure generation, this is the creative brief. For transformation, this provides guidance on how to adapt the creative. For refinement, this describes the desired changes."
    },
    "generated_creative_ref": {
      "type": "string",
      "description": "Reference to a previous build_creative output. When provided, the creative agent uses its stored manifest as the starting point, making creative_manifest optional. If both are provided, creative_manifest takes precedence. The message field provides refinement instructions."
    },
    "creative_manifest": {
      "$ref": "/schemas/core/creative-manifest.json",
      "description": "Creative manifest to transform or generate from. For pure generation, this should include the target format_id and any required input assets. For transformation (e.g., resizing, reformatting), this is the complete creative to adapt."
    },
    "target_format_id": {
      "$ref": "/schemas/core/format-id.json",
      "description": "Format ID to generate. The format definition specifies required input assets and output structure."
    },
    "brand": {
      "$ref": "/schemas/core/brand-ref.json",
      "description": "Brand reference for creative generation. Resolved to full brand identity (colors, logos, tone) at execution time."
    },
    "creative_brief": {
      "$ref": "/schemas/core/creative-brief-ref.json",
      "description": "Campaign-level creative brief with objective, audience, messaging, and reference assets. Can be an inline brief object or a URL to a hosted brief. Supplements the natural language message with structured creative direction."
    },
    "context": {
      "$ref": "/schemas/core/context.json"
    },
    "ext": {
      "$ref": "/schemas/core/ext.json"
    }
  },
  "required": [
    "target_format_id"
  ],
  "additionalProperties": true
}
