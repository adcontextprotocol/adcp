{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/media-buy/get-capabilities-response.json",
  "title": "Get Capabilities Response",
  "description": "Response payload for get_capabilities task. Describes protocol support, execution capabilities, and portfolio information. Replaces list_authorized_properties with expanded capability declaration.",
  "type": "object",
  "properties": {
    "protocol": {
      "type": "object",
      "description": "Protocol-level capabilities describing AdCP version support and optional features",
      "properties": {
        "adcp_major_versions": {
          "type": "array",
          "description": "AdCP major versions supported by this seller. Major versions indicate breaking changes.",
          "items": {
            "type": "integer",
            "minimum": 1
          },
          "minItems": 1
        },
        "features": {
          "type": "object",
          "description": "Optional protocol features supported. If a feature is declared true, the seller MUST honor requests using that feature.",
          "properties": {
            "inline_creative_management": {
              "type": "boolean",
              "description": "Supports creatives provided inline in create_media_buy requests"
            },
            "property_list_filtering": {
              "type": "boolean",
              "description": "Honors property_list parameter in get_products to filter results to buyer-approved properties"
            },
            "content_standards": {
              "type": "boolean",
              "description": "Full support for content_standards configuration including sampling rates and category filtering"
            }
          },
          "additionalProperties": {
            "type": "boolean"
          }
        }
      },
      "required": ["adcp_major_versions"]
    },
    "execution": {
      "type": "object",
      "description": "Technical execution capabilities describing ad serving, creative specs, and targeting support",
      "properties": {
        "axe_integrations": {
          "type": "array",
          "description": "Agentic ad exchange (AXE) integrations supported. URLs are canonical identifiers for exchanges this seller can execute through.",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },
        "creative_specs": {
          "type": "object",
          "description": "Creative specification support",
          "properties": {
            "vast_versions": {
              "type": "array",
              "description": "VAST versions supported for video creatives",
              "items": {
                "type": "string",
                "pattern": "^[0-9]+\\.[0-9]+$"
              }
            },
            "mraid_versions": {
              "type": "array",
              "description": "MRAID versions supported for rich media mobile creatives",
              "items": {
                "type": "string",
                "pattern": "^[0-9]+\\.[0-9]+$"
              }
            },
            "vpaid": {
              "type": "boolean",
              "description": "VPAID support for interactive video ads"
            },
            "simid": {
              "type": "boolean",
              "description": "SIMID support for interactive video ads"
            }
          }
        },
        "targeting": {
          "type": "object",
          "description": "Targeting capabilities. If declared true/supported, buyer can use these targeting parameters and seller MUST honor them.",
          "properties": {
            "geo_countries": {
              "type": "boolean",
              "description": "Supports country-level geo targeting using ISO 3166-1 alpha-2 codes (e.g., 'US', 'GB', 'DE')"
            },
            "geo_regions": {
              "type": "boolean",
              "description": "Supports region/state-level geo targeting using ISO 3166-2 subdivision codes (e.g., 'US-NY', 'GB-SCT', 'DE-BY')"
            },
            "geo_metros": {
              "type": "object",
              "description": "Metro area targeting support. Specifies which classification systems are supported.",
              "properties": {
                "nielsen_dma": {
                  "type": "boolean",
                  "description": "Supports Nielsen DMA codes (US market, e.g., '501' for NYC)"
                },
                "uk_itl1": {
                  "type": "boolean",
                  "description": "Supports UK ITL Level 1 regions"
                },
                "uk_itl2": {
                  "type": "boolean",
                  "description": "Supports UK ITL Level 2 regions"
                },
                "eurostat_nuts2": {
                  "type": "boolean",
                  "description": "Supports Eurostat NUTS Level 2 regions (EU)"
                }
              }
            },
            "geo_postal_areas": {
              "type": "object",
              "description": "Postal area targeting support. Specifies which postal code systems are supported. System names encode country and precision.",
              "properties": {
                "us_zip": {
                  "type": "boolean",
                  "description": "US 5-digit ZIP codes (e.g., '10001')"
                },
                "us_zip_plus_four": {
                  "type": "boolean",
                  "description": "US 9-digit ZIP+4 codes (e.g., '10001-1234')"
                },
                "gb_outward": {
                  "type": "boolean",
                  "description": "UK postcode district / outward code (e.g., 'SW1', 'EC1')"
                },
                "gb_full": {
                  "type": "boolean",
                  "description": "UK full postcode (e.g., 'SW1A 1AA')"
                },
                "ca_fsa": {
                  "type": "boolean",
                  "description": "Canadian Forward Sortation Area (e.g., 'K1A')"
                },
                "ca_full": {
                  "type": "boolean",
                  "description": "Canadian full postal code (e.g., 'K1A 0B1')"
                },
                "de_plz": {
                  "type": "boolean",
                  "description": "German Postleitzahl, 5 digits (e.g., '10115')"
                },
                "fr_code_postal": {
                  "type": "boolean",
                  "description": "French code postal, 5 digits (e.g., '75001')"
                },
                "au_postcode": {
                  "type": "boolean",
                  "description": "Australian postcode, 4 digits (e.g., '2000')"
                }
              }
            }
          }
        }
      }
    },
    "portfolio": {
      "type": "object",
      "description": "Information about the seller's inventory portfolio. Equivalent to previous list_authorized_properties response fields.",
      "properties": {
        "publisher_domains": {
          "type": "array",
          "description": "Publisher domains this seller is authorized to represent. Buyers should fetch each publisher's adagents.json for property definitions.",
          "items": {
            "type": "string",
            "pattern": "^[a-z0-9]([a-z0-9-]*[a-z0-9])?(\\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$"
          },
          "minItems": 1
        },
        "primary_channels": {
          "type": "array",
          "description": "Primary advertising channels in this portfolio",
          "items": {
            "$ref": "/schemas/enums/channels.json"
          }
        },
        "primary_countries": {
          "type": "array",
          "description": "Primary countries (ISO 3166-1 alpha-2) where inventory is concentrated",
          "items": {
            "type": "string",
            "pattern": "^[A-Z]{2}$"
          }
        },
        "description": {
          "type": "string",
          "description": "Markdown-formatted description of the inventory portfolio",
          "maxLength": 5000
        },
        "advertising_policies": {
          "type": "string",
          "description": "Advertising content policies, restrictions, and guidelines",
          "maxLength": 10000
        }
      },
      "required": ["publisher_domains"]
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when capabilities were last updated. Buyers can use this for cache invalidation."
    },
    "errors": {
      "type": "array",
      "description": "Task-specific errors and warnings",
      "items": {
        "$ref": "/schemas/core/error.json"
      }
    },
    "context": {
      "$ref": "/schemas/core/context.json"
    },
    "ext": {
      "$ref": "/schemas/core/ext.json"
    }
  },
  "required": ["protocol", "portfolio"],
  "additionalProperties": true
}
