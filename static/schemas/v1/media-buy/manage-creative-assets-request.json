{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/media-buy/manage-creative-assets-request.json",
  "title": "Manage Creative Assets Request",
  "description": "Request parameters for managing creative assets in the centralized library",
  "type": "object",
  "properties": {
    "adcp_version": {
      "type": "string",
      "description": "AdCP schema version for this request",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "default": "1.4.0"
    },
    "action": {
      "type": "string",
      "description": "Creative management action to perform",
      "enum": ["upload", "list", "update", "assign", "unassign", "delete"]
    }
  },
  "required": ["action"],
  "allOf": [
    {
      "if": {
        "properties": { "action": { "const": "upload" } }
      },
      "then": {
        "properties": {
          "assets": {
            "type": "array",
            "description": "Array of creative assets to upload to library",
            "items": {
              "$ref": "/schemas/v1/core/creative-asset.json"
            },
            "minItems": 1
          }
        },
        "required": ["assets"]
      }
    },
    {
      "if": {
        "properties": { "action": { "const": "list" } }
      },
      "then": {
        "properties": {
          "filters": {
            "type": "object",
            "description": "Filter criteria for querying creatives",
            "properties": {
              "format": {
                "type": "string",
                "description": "Creative format type filter"
              },
              "status": {
                "$ref": "/schemas/v1/enums/creative-status.json"
              },
              "created_after": {
                "type": "string",
                "format": "date-time",
                "description": "Minimum creation date (ISO 8601)"
              },
              "created_before": {
                "type": "string",
                "format": "date-time",
                "description": "Maximum creation date (ISO 8601)"
              },
              "name_contains": {
                "type": "string",
                "description": "Search term within creative names"
              },
              "assigned_to_package": {
                "type": "string",
                "description": "Show creatives assigned to specific package"
              },
              "unassigned": {
                "type": "boolean",
                "description": "Show only unassigned creatives"
              }
            },
            "additionalProperties": false
          },
          "pagination": {
            "type": "object",
            "description": "Pagination parameters",
            "properties": {
              "limit": {
                "type": "integer",
                "minimum": 1,
                "maximum": 100,
                "default": 50,
                "description": "Maximum number of results to return"
              },
              "offset": {
                "type": "integer",
                "minimum": 0,
                "default": 0,
                "description": "Number of results to skip"
              }
            },
            "additionalProperties": false
          }
        }
      }
    },
    {
      "if": {
        "properties": { "action": { "const": "update" } }
      },
      "then": {
        "properties": {
          "creative_id": {
            "type": "string",
            "description": "ID of creative to update"
          },
          "updates": {
            "type": "object",
            "description": "Fields to update",
            "properties": {
              "name": {
                "type": "string",
                "description": "Updated creative name"
              },
              "click_url": {
                "type": "string",
                "format": "uri",
                "description": "Updated landing page URL"
              }
            },
            "additionalProperties": false,
            "minProperties": 1
          }
        },
        "required": ["creative_id", "updates"]
      }
    },
    {
      "if": {
        "properties": { "action": { "const": "assign" } }
      },
      "then": {
        "properties": {
          "creative_ids": {
            "type": "array",
            "description": "Creative IDs to assign",
            "items": {
              "type": "string"
            },
            "minItems": 1
          },
          "media_buy_id": {
            "type": "string",
            "description": "Publisher's media buy ID"
          },
          "buyer_ref": {
            "type": "string",
            "description": "Buyer's media buy reference"
          },
          "package_assignments": {
            "type": "array",
            "description": "Package IDs to assign creatives to",
            "items": {
              "type": "string"
            },
            "minItems": 1
          }
        },
        "required": ["creative_ids", "package_assignments"],
        "oneOf": [
          {
            "required": ["media_buy_id"]
          },
          {
            "required": ["buyer_ref"]
          }
        ]
      }
    },
    {
      "if": {
        "properties": { "action": { "const": "unassign" } }
      },
      "then": {
        "properties": {
          "creative_ids": {
            "type": "array",
            "description": "Creative IDs to unassign",
            "items": {
              "type": "string"
            },
            "minItems": 1
          },
          "package_ids": {
            "type": "array",
            "description": "Specific packages to unassign from (if omitted, unassigns from all)",
            "items": {
              "type": "string"
            }
          }
        },
        "required": ["creative_ids"]
      }
    },
    {
      "if": {
        "properties": { "action": { "const": "delete" } }
      },
      "then": {
        "properties": {
          "creative_ids": {
            "type": "array",
            "description": "Creative IDs to delete",
            "items": {
              "type": "string"
            },
            "minItems": 1
          },
          "archive": {
            "type": "boolean",
            "default": true,
            "description": "Whether to archive (soft delete) vs permanently delete"
          }
        },
        "required": ["creative_ids"]
      }
    }
  ],
  "additionalProperties": false
}