{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/creative/asset-types/daast.json",
  "title": "DAAST Asset Type Schema",
  "description": "Schema for DAAST (Digital Audio Ad Serving Template) XML tags for third-party audio ad serving",
  "type": "object",
  "properties": {
    "asset_id": {
      "type": "string",
      "pattern": "^[a-z0-9_]+$",
      "description": "Unique identifier for this asset within the format"
    },
    "asset_type": {
      "type": "string",
      "const": "daast"
    },
    "required": {
      "type": "boolean",
      "description": "Whether this asset is mandatory for the format"
    },
    "tag_url": {
      "type": "string",
      "format": "uri",
      "description": "URL endpoint that returns DAAST XML response"
    },
    "inline_xml": {
      "type": "string",
      "description": "Inline DAAST XML content (alternative to tag_url)"
    },
    "daast_version": {
      "type": "string",
      "enum": ["1.0", "1.1"],
      "description": "DAAST specification version supported",
      "default": "1.1"
    },
    "max_wrapper_depth": {
      "type": "integer",
      "minimum": 0,
      "maximum": 5,
      "default": 3,
      "description": "Maximum allowed wrapper/redirect depth"
    },
    "duration": {
      "type": "object",
      "description": "Expected audio duration requirements",
      "properties": {
        "min_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Minimum audio duration in seconds"
        },
        "max_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum audio duration in seconds"
        },
        "exact_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Exact required duration in seconds (if applicable)"
        }
      }
    },
    "tracking_requirements": {
      "type": "object",
      "properties": {
        "required_events": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "start",
              "firstQuartile",
              "midpoint",
              "thirdQuartile",
              "complete",
              "impression",
              "pause",
              "resume",
              "skip",
              "mute",
              "unmute"
            ]
          },
          "description": "Tracking events that must be supported"
        },
        "optional_events": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "start",
              "firstQuartile",
              "midpoint",
              "thirdQuartile",
              "complete",
              "impression",
              "pause",
              "resume",
              "skip",
              "mute",
              "unmute"
            ]
          },
          "description": "Additional tracking events that may be supported"
        }
      }
    },
    "companion_ads": {
      "type": "object",
      "description": "Requirements for companion display ads",
      "properties": {
        "required": {
          "type": "boolean",
          "default": false,
          "description": "Whether companion ads are required"
        },
        "dimensions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "width": {"type": "integer", "minimum": 1},
              "height": {"type": "integer", "minimum": 1}
            },
            "required": ["width", "height"]
          },
          "description": "Accepted companion ad dimensions"
        }
      }
    },
    "fallback_required": {
      "type": "boolean",
      "default": true,
      "description": "Whether a fallback audio asset must be provided if DAAST tag fails"
    },
    "supported_macros": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "List of universal macros supported by this DAAST tag (e.g., CACHEBUSTER, CLICK_URL)"
    },
    "required_macros": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "List of universal macros that must be provided for DAAST tag to function"
    }
  },
  "required": ["asset_id", "asset_type", "required"],
  "oneOf": [
    {"required": ["tag_url"]},
    {"required": ["inline_xml"]}
  ],
  "additionalProperties": false
}
