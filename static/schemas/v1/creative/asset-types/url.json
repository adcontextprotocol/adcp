{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/creative/asset-types/url.json",
  "title": "URL Asset Type Schema",
  "description": "Schema for URL assets including clickthrough URLs, tracking pixels, and landing pages",
  "type": "object",
  "properties": {
    "asset_id": {
      "type": "string",
      "pattern": "^[a-z0-9_]+$",
      "description": "Unique identifier for this asset within the format"
    },
    "asset_type": {
      "type": "string",
      "const": "url"
    },
    "required": {
      "type": "boolean",
      "description": "Whether this asset is mandatory for the format"
    },
    "url_purpose": {
      "type": "string",
      "enum": [
        "clickthrough",
        "landing_page",
        "tracking_pixel",
        "impression_tracker",
        "viewability_tracker",
        "video_start_tracker",
        "video_complete_tracker",
        "quartile_tracker",
        "error_tracker"
      ],
      "description": "The purpose/usage of this URL"
    },
    "protocol": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["http", "https"]
      },
      "minItems": 1,
      "uniqueItems": true,
      "default": ["https"],
      "description": "Allowed URL protocols"
    },
    "ssl_required": {
      "type": "boolean",
      "default": true,
      "description": "Whether HTTPS is required"
    },
    "max_length": {
      "type": "integer",
      "minimum": 100,
      "maximum": 8192,
      "default": 2048,
      "description": "Maximum URL length in characters"
    },
    "supported_macros": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "List of universal macros that can be used in URL (e.g., {CLICK_URL}, {CACHEBUSTER}, {DEVICE_TYPE})"
    },
    "required_macros": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "List of universal macros that must be provided for URL to function"
    },
    "url_encoding": {
      "type": "object",
      "properties": {
        "required": {
          "type": "boolean",
          "default": true,
          "description": "Whether URL encoding is required for query parameters"
        },
        "encoding_type": {
          "type": "string",
          "enum": ["standard", "component", "form"],
          "default": "component",
          "description": "Type of URL encoding to use"
        }
      },
      "description": "URL encoding requirements"
    },
    "validation": {
      "type": "object",
      "properties": {
        "reachability_check": {
          "type": "boolean",
          "default": false,
          "description": "Whether the URL must be reachable/testable at submission time"
        },
        "allowed_domains": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true,
          "description": "Whitelist of allowed domains (if restricted)"
        },
        "blocked_domains": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true,
          "description": "Blacklist of blocked domains"
        },
        "max_redirects": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "default": 3,
          "description": "Maximum number of HTTP redirects allowed"
        },
        "redirect_timeout_ms": {
          "type": "integer",
          "minimum": 100,
          "maximum": 10000,
          "default": 3000,
          "description": "Timeout for following redirects in milliseconds"
        }
      },
      "description": "URL validation requirements"
    },
    "tracking_method": {
      "type": "string",
      "enum": ["GET", "POST", "pixel", "beacon"],
      "description": "HTTP method for tracking URLs"
    },
    "response_requirements": {
      "type": "object",
      "properties": {
        "expected_status_codes": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 100,
            "maximum": 599
          },
          "default": [200, 204, 302],
          "description": "Expected HTTP status codes for successful tracking"
        },
        "timeout_ms": {
          "type": "integer",
          "minimum": 100,
          "maximum": 30000,
          "default": 5000,
          "description": "Maximum response time in milliseconds"
        }
      },
      "description": "Requirements for URL responses (primarily for tracking URLs)"
    },
    "privacy_compliance": {
      "type": "object",
      "properties": {
        "gdpr_consent_required": {
          "type": "boolean",
          "description": "Whether GDPR consent must be obtained before firing this URL"
        },
        "ccpa_compliant": {
          "type": "boolean",
          "description": "Whether this URL is CCPA compliant"
        },
        "pii_allowed": {
          "type": "boolean",
          "default": false,
          "description": "Whether personally identifiable information can be included"
        }
      },
      "description": "Privacy and compliance requirements"
    },
    "default_value": {
      "type": "string",
      "format": "uri",
      "description": "Default URL value if not provided"
    },
    "notes": {
      "type": "string",
      "maxLength": 500,
      "description": "Additional requirements or restrictions"
    }
  },
  "required": ["asset_id", "asset_type", "required", "url_purpose"],
  "additionalProperties": false
}
