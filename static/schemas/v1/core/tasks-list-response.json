{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/core/tasks-list-response.json",
  "title": "Tasks List Response",
  "description": "Response from task listing query with filtered results and state reconciliation data across all AdCP domains",
  "type": "object",
  "properties": {
    "adcp_version": {
      "type": "string",
      "description": "AdCP schema version used for this response",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "message": {
      "type": "string",
      "description": "Human-readable result message summarizing task query results"
    },
    "context_id": {
      "type": "string",
      "description": "Context ID for tracking related operations"
    },
    "query_summary": {
      "type": "object",
      "description": "Summary of the query that was executed",
      "properties": {
        "total_matching": {
          "type": "integer",
          "description": "Total number of tasks matching filters (across all pages)",
          "minimum": 0
        },
        "returned": {
          "type": "integer",
          "description": "Number of tasks returned in this response",
          "minimum": 0
        },
        "domain_breakdown": {
          "type": "object",
          "description": "Count of tasks by domain",
          "properties": {
            "media-buy": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of media-buy tasks in results"
            },
            "signals": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of signals tasks in results"
            }
          },
          "additionalProperties": false
        },
        "status_breakdown": {
          "type": "object",
          "description": "Count of tasks by status",
          "additionalProperties": {
            "type": "integer",
            "minimum": 0
          }
        },
        "filters_applied": {
          "type": "array",
          "description": "List of filters that were applied to the query",
          "items": {
            "type": "string"
          }
        },
        "sort_applied": {
          "type": "object",
          "description": "Sort order that was applied",
          "properties": {
            "field": {
              "type": "string"
            },
            "direction": {
              "type": "string",
              "enum": ["asc", "desc"]
            }
          },
          "required": ["field", "direction"],
          "additionalProperties": false
        }
      },
      "required": ["total_matching", "returned"],
      "additionalProperties": false
    },
    "tasks": {
      "type": "array",
      "description": "Array of tasks matching the query criteria",
      "items": {
        "type": "object",
        "properties": {
          "task_id": {
            "type": "string",
            "description": "Unique identifier for this task"
          },
          "task_type": {
            "type": "string",
            "description": "Type of AdCP operation",
            "enum": ["create_media_buy", "update_media_buy", "sync_creatives", "activate_signal", "get_signals"]
          },
          "domain": {
            "type": "string",
            "description": "AdCP domain this task belongs to",
            "enum": ["media-buy", "signals"]
          },
          "status": {
            "$ref": "/schemas/v1/enums/task-status.json",
            "description": "Current task status"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the task was initially created (ISO 8601)"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the task was last updated (ISO 8601)"
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the task completed (ISO 8601, only for completed/failed/canceled tasks)"
          },
          "message": {
            "type": "string",
            "description": "Current human-readable status message"
          },
          "context": {
            "type": "object",
            "description": "Task context information for identification and tracking",
            "properties": {
              "buyer_ref": {
                "type": "string",
                "description": "Buyer reference from original request"
              },
              "media_buy_id": {
                "type": "string",
                "description": "Media buy ID if created/being modified (media-buy tasks)"
              },
              "package_ids": {
                "type": "array",
                "description": "Package IDs if relevant to task (media-buy tasks)",
                "items": {
                  "type": "string"
                }
              },
              "creative_count": {
                "type": "integer",
                "description": "Number of creatives for sync_creatives tasks",
                "minimum": 0
              },
              "signal_id": {
                "type": "string",
                "description": "Signal ID for signal tasks"
              },
              "signal_type": {
                "type": "string",
                "description": "Type of signal being sent (signal tasks)"
              },
              "endpoints_notified": {
                "type": "integer",
                "description": "Number of endpoints notified for signal tasks",
                "minimum": 0
              }
            },
            "additionalProperties": false
          },
          "has_webhook": {
            "type": "boolean",
            "description": "Whether this task has webhook configuration"
          },
          "result": {
            "type": "object",
            "description": "Full task result for completed tasks (only included if include_result was true in request)",
            "additionalProperties": true
          }
        },
        "required": ["task_id", "task_type", "domain", "status", "created_at", "updated_at", "message"],
        "additionalProperties": false
      }
    },
    "pagination": {
      "type": "object",
      "description": "Pagination information",
      "properties": {
        "limit": {
          "type": "integer",
          "description": "Limit that was applied to this query",
          "minimum": 1
        },
        "offset": {
          "type": "integer", 
          "description": "Offset that was applied to this query",
          "minimum": 0
        },
        "has_more": {
          "type": "boolean",
          "description": "Whether there are more tasks beyond this page"
        },
        "next_offset": {
          "type": "integer",
          "description": "Offset to use for next page (only present if has_more is true)",
          "minimum": 0
        }
      },
      "required": ["limit", "offset", "has_more"],
      "additionalProperties": false
    }
  },
  "required": ["adcp_version", "message", "query_summary", "tasks", "pagination"],
  "additionalProperties": false
}