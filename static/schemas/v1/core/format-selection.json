{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/core/format-selection.json",
  "title": "Format Selection",
  "description": "Specification for how formats should be selected from multi-format products",
  "type": "object",
  "properties": {
    "strategy": {
      "type": "string",
      "enum": ["optimal_coverage", "highest_priority", "cost_efficient", "responsive_first", "single_format", "custom"],
      "description": "Selection strategy for choosing formats from available options"
    },
    "preferred_formats": {
      "type": "array",
      "description": "Buyer's preferred format IDs in priority order",
      "items": {"type": "string"}
    },
    "excluded_formats": {
      "type": "array",
      "description": "Format IDs to exclude from selection",
      "items": {"type": "string"}
    },
    "max_formats": {
      "type": "integer",
      "minimum": 1,
      "description": "Maximum number of formats to select for this package"
    },
    "min_formats": {
      "type": "integer", 
      "minimum": 1,
      "description": "Minimum number of formats required for this package"
    },
    "viewport_priority": {
      "type": "string",
      "enum": ["desktop_first", "mobile_first", "tablet_first", "balanced"],
      "description": "Which viewport size to prioritize for responsive formats"
    },
    "placement_type_preferences": {
      "type": "array",
      "description": "Preferred placement type IDs for multi-size handling",
      "items": {"type": "string"}
    },
    "custom_rules": {
      "type": "object",
      "description": "Custom selection rules for advanced scenarios",
      "properties": {
        "aspect_ratio_preference": {
          "type": "array",
          "items": {"type": "string"}
        },
        "size_constraints": {
          "type": "object",
          "properties": {
            "min_width": {"type": "integer"},
            "max_width": {"type": "integer"},
            "min_height": {"type": "integer"},
            "max_height": {"type": "integer"}
          }
        },
        "creative_constraints": {
          "type": "object",
          "additionalProperties": true
        }
      }
    }
  },
  "required": ["strategy"],
  "additionalProperties": false
}