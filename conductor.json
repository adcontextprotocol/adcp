{
  "scripts": {
    "setup": "git config core.hooksPath .husky && npm install && uv sync && open -a Docker && echo 'Waiting for Docker to start...' && TRIES=0 && until docker info > /dev/null 2>&1; do TRIES=$((TRIES+1)); if [ $TRIES -gt 30 ]; then echo 'ERROR: Docker failed to start after 30s' && exit 1; fi; sleep 1; done && echo 'Docker is ready' && docker compose up -d postgres && echo 'Waiting for postgres to be healthy...' && TRIES=0 && until docker compose ps postgres --format json 2>/dev/null | grep -q '\"Health\":\"healthy\"' || docker compose ps postgres 2>/dev/null | grep -q healthy; do TRIES=$((TRIES+1)); if [ $TRIES -gt 30 ]; then echo 'ERROR: Postgres failed to become healthy after 30s' && exit 1; fi; sleep 1; done && echo 'Postgres is healthy' && DB_PORT=$(docker compose port postgres 5432 | cut -d: -f2) && if [ -z \"$DB_PORT\" ]; then echo 'ERROR: Failed to get postgres port' && exit 1; fi && echo \"Postgres running on port $DB_PORT\" && APP_PORT=$((50000 + RANDOM % 10000)) && if [ -f \"$CONDUCTOR_ROOT_PATH/.env.local\" ]; then cat \"$CONDUCTOR_ROOT_PATH/.env.local\" > .env.local; fi && echo \"DATABASE_URL=postgresql://adcp:localdev@localhost:$DB_PORT/adcp_registry\" >> .env.local && echo \"DATABASE_SSL=false\" >> .env.local && echo \"CONDUCTOR_PORT=$APP_PORT\" >> .env.local && if [ -f \"$CONDUCTOR_ROOT_PATH/.env\" ]; then cat \"$CONDUCTOR_ROOT_PATH/.env\" >> .env.local; fi && npm run db:migrate",
    "run": "if ! docker info > /dev/null 2>&1; then echo 'Starting Docker...' && open -a Docker && TRIES=0 && until docker info > /dev/null 2>&1; do TRIES=$((TRIES+1)); if [ $TRIES -gt 30 ]; then echo 'ERROR: Docker failed to start' && exit 1; fi; sleep 1; done; fi && if ! docker compose ps postgres 2>/dev/null | grep -q 'Up'; then echo 'Starting postgres...' && docker compose up -d postgres && TRIES=0 && until docker compose ps postgres 2>/dev/null | grep -q healthy; do TRIES=$((TRIES+1)); if [ $TRIES -gt 30 ]; then echo 'ERROR: Postgres failed to start' && exit 1; fi; sleep 1; done; fi && APP_PORT=$(grep CONDUCTOR_PORT .env.local 2>/dev/null | cut -d= -f2) && if [ -z \"$APP_PORT\" ]; then APP_PORT=3000; fi && echo \"Starting dev server on port $APP_PORT...\" && (sleep 3 && open \"http://localhost:$APP_PORT/dashboard\") & npm run dev"
  }
}
